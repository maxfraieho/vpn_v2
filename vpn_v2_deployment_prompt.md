# Промт для Qwen Coder: Розгортання VPN v2 системи

Ти є експертом у сфері DevOps, мережевої безпеки та автоматизації. Тобі необхідно налаштувати систему VPN v2, яка дозволяє одночасно використовувати різні IP-адреси для різних акаунтів через систему проксі-серверів з роутингом на основі акаунта.

## Контекст

Система має забезпечувати наступне:
- Обслуговування двох акаунтів (arsen.k111999@gmail.com та lekov00@gmail.com)
- Кожен акаунт має отримувати різні IP-адреси з Швейцарії
- Один акаунт використовує Tailscale (100.100.74.9) для отримання Swiss IP
- Другий акаунт використовує Tor з виходом у Швейцарії
- Система має працювати на Termux (Android) з підтримкою віддаленого доступу

## Архітектура системи

- Smart Proxy v2 (Python) на портах 8888 та 8889
- Survey Automation v2 LITE (Python) на порті 8090
- Tor (SOCKS5) для одного акаунта
- Tailscale для іншого акаунта
- HTTP API для керування процесами опитування

## Завдання

Створи та розгорни повну систему VPN v2 з наступним функціоналом:

1. Встанови всі необхідні залежності (Tor, Python, aiohttp, requests тощо)
2. Створи всі необхідні файли з правильними конфігураціями
3. Налаштуй роутинг та перенаправлення на основі акаунта
4. Створи скрипти для запуску, зупинки та моніторингу сервісів
5. Забезпеч стабільну роботу всіх компонентів
6. Створи діагностичні інструменти для перевірки системи

## Конкретні компоненти для реалізації

### 1. config.json
Створи файл конфігурації з двома акаунтами:
- arsen.k111999@gmail.com → порт 8888 → Tailscale (Swiss IP)
- lekov00@gmail.com → порт 8889 → Tor (Swiss IP через CH exit nodes)

### 2. smart_proxy_v2.py
Реалізуй HTTP-проксі-сервер, який:
- Обробляє запити на портах 8888 та 8889
- Маршрутизує трафік відповідно до акаунта користувача
- Направляє трафік до відповідного upstream (Tailscale або Tor)
- Зберігає логи у proxy.log

### 3. survey_automation_v2_lite.py
Створи сервіс для автоматизації опитувань, який:
- Використовує лише requests (без Playwright для сумісності з Termux)
- Має REST API на порті 8090
- Використовує правильні проксі для кожного акаунта
- Перевіряє, чи IP знаходиться в Швейцарії
- Зберігає та відновлює cookies
- Зберігає логи у survey.log

### 4. manager_v2.sh
Створи скрипт для управління всіма сервісами:
- Запуск/зупинка/перезапуск всіх компонентів
- Перевірка статусу всіх сервісів
- Ведення PID файлів
- Відображення зручного інтерфейсу користувача

### 5. Діагностичні скрипти
- diagnostic.sh - комплексна перевірка всіх компонентів
- test_api.sh - перевірка роботи API сервісів
- test_routing.sh - перевірка правильного маршрутизування IP

### 6. torrc
Конфігурація Tor для виходу лише через швейцарські вузли

## Вимоги до реалізації

- Всі файли мають бути створені у теці ~/vpn_v2
- Права доступу до файлів мають бути встановлені правильно
- Забезпеч стабільну роботу навіть у середовищі Termux
- Створи механізми автозапуску при старті системи
- Впровадь належне логування для всіх компонентів
- Створи інструменти для усунення несправностей

## Очікувані результати

Після розгортання система має:
- Запускатися однією командою
- Показувати різні Swiss IP для різних акаунтів
- Дозволяти виконувати опитування через API
- Бути стійкою до перезавантажень
- Мати зручні інструменти для моніторингу та діагностики