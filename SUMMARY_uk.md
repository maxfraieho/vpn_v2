# Підсумок системи VPN v2

## Поточний статус: ✅ Повністю функціональна

### Огляд сервісів
- **Сервіс Tor**: ✅ Працює (Порт 9050)
  - Надає SOCKS5 проксі
  - Успішно маршрутизує через виходи в Швейцарії
  - Доступний через IP-адресу Tailscale
  - Перевірка IP показує Швейцарське розташування (код країни: CH)

- **Смарт-проксі**: ✅ Працює (Порти 8888, 8889)
  - Два незалежних HTTP проксі для різних облікових записів
  - Порт 8888: Пряме з'єднання через Tailscale (arsen.k111999@gmail.com)
  - Порт 8889: Маршрутизація через Tor (lekov00@gmail.com)
  - Обидва проксі надають швейцарські IP адреси

- **Автоматизація опитувань**: ✅ Працює (Порт 8090)
  - Внутрішній сервіс API
  - Перевірка здоров'я та моніторинг статусу

## Деталі конфігурації
- **Tailscale IP**: 100.100.74.9
- **Tor SOCKS5 Порт**: 9050
- **Порти проксі**: 8888 (Tailscale), 8889 (Tor)
- **Порт опитувань**: 8090

## Налаштування браузера для Windows Chrome

### Для облікового запису 1: arsen.k111999@gmail.com (Пряме з'єднання Tailscale)
**Призначення**: Пряме з'єднання через Tailscale з швейцарським IP

**Налаштування Chrome:**
1. Відкрити Chrome
2. Перейти до Налаштування → Система → Відкрити налаштування проксі
3. Налаштування Windows → Мережа та Інтернет → Проксі
4. Ручне налаштування проксі:
   - HTTP проксі: 100.100.74.9 порт 8888
   - HTTPS проксі: 100.100.74.9 порт 8888
5. Зберегти налаштування

**Альтернативний метод (Розширення Chrome):**
1. Встановити розширення "Proxy SwitchyOmega"
2. Створити новий профіль:
   - Назва: Tailscale_VPN_Arsen
   - Тип: HTTP/HTTPS
   - Сервер: 100.100.74.9
   - Порт: 8888
3. Застосувати зміни

**Перевірка для облікового запису Arsen:**
```bash
# Перевірка IP та розташування
curl -x http://100.100.74.9:8888 http://httpbin.org/ip
# Очікувано: {"origin": "46.253.188.140"}

# Перевірка країни
curl -x http://100.100.74.9:8888 https://ipapi.co/country
# Очікувано: CH (Швейцарія)
```

### Для облікового запису 2: lekov00@gmail.com (Маршрутизація через Tor)
**Призначення**: Маршрутизація через Tor з виходом в Швейцарії

**Налаштування Chrome:**
1. Відкрити Chrome
2. Перейти до Налаштування → Система → Відкрити налаштування проксі
3. Налаштування Windows → Мережа та Інтернет → Проксі
4. Ручне налаштування проксі:
   - HTTP проксі: 100.100.74.9 порт 8889
   - HTTPS проксі: 100.100.74.9 порт 8889
5. Зберегти налаштування

**Альтернативний метод (Розширення Chrome):**
1. Встановити розширення "Proxy SwitchyOmega"
2. Створити новий профіль:
   - Назва: Tor_VPN_Lena
   - Тип: HTTP/HTTPS
   - Сервер: 100.100.74.9
   - Порт: 8889
3. Застосувати зміни

**Перевірка для облікового запису Lena:**
```bash
# Перевірка IP та розташування
curl -x http://100.100.74.9:8889 http://httpbin.org/ip
# Очікувано: {"origin": "195.176.3.24"}

# Перевірка країни
curl -x http://100.100.74.9:8889 https://ipapi.co/country
# Очікувано: CH (Швейцарія)
```

## Інструкції для одночасного використання

### Використання обох облікових записів в різних екземплярах Chrome:
1. **Основний Chrome** (Обліковий запис Arsen):
   - Налаштувати системний проксі на 100.100.74.9:8888
   - Увійти до сервісів arsen.k111999@gmail.com

2. **Додатковий Chrome** (Обліковий запис Lena):
   - Створити ярлик Chrome з іншою директорією даних користувача:
     ```
     "C:\Program Files\Google\Chrome\Application\chrome.exe" --user-data-dir="C:\ChromeProfiles\Lena" --proxy-server="http://100.100.74.9:8889"
   - Увійти до сервісів lekov00@gmail.com

## Команди тестування

### Пряме тестування Tor:
```bash
# Тест Tor SOCKS5 напряму
curl --socks5-hostname 127.0.0.1:9050 https://ipapi.co/json/
```

### Тестування проксі:
```bash
# Тест проксі Arsen (Обліковий запис 1)
curl -x http://127.0.0.1:8888 http://httpbin.org/ip

# Тест проксі Lena (Обліковий запис 2)
curl -x http://127.0.0.1:8889 http://httpbin.org/ip
```

### Перевірка здоров'я сервісів:
```bash
# API опитувань - здоров'я
curl http://127.0.0.1:8090/health

# API опитувань - статус
curl http://127.0.0.1:8090/status
```

## Відомі обмеження

1. **Підтримка HTTPS**: 
   - Поточна реалізація проксі підтримує лише HTTP
   - Метод CONNECT для HTTPS не реалізований
   - Для HTTPS сайтів використовуйте Tor SOCKS5 напряму (127.0.0.1:9050)

2. **Відображення статусу портів**:
   - Менеджер показує "Порт не слухає", але проксі працюють
   - Це проблема відображення, а не функціональна проблема

3. **Ізоляція облікових записів**:
   - Кожен обліковий запис використовує окремі порти проксі
   - Немає перешкоджання між обліковими записами
   - Незалежна маршрутизація для кожного користувача

## Вирішення проблем

### Якщо проксі не відповідають:
1. Перевірити статус сервісів:
   ```bash
   cd ~/vpn_v2 && bash manager_v2.sh status
   ```

2. Перезапустити сервіси:
   ```bash
   cd ~/vpn_v2 && bash manager_v2.sh restart
   ```

### Якщо визначається неправильна країна:
1. Перевірити з'єднання Tor:
   ```bash
   curl --socks5-hostname 127.0.0.1:9050 https://ipapi.co/country
   ```

2. Перевірити логи проксі:
   ```bash
   tail -n 50 ~/vpn_v2/proxy.log
   ```

## Порти системи

| Сервіс | Порт | Протокол | Призначення |
|--------|------|----------|-------------|
| Tor SOCKS5 | 9050 | SOCKS5 | Прямий доступ до Tor |
| Проксі Tailscale | 8888 | HTTP | Обліковий запис Arsen (Пряме з'єднання) |
| Проксі Tor | 8889 | HTTP | Обліковий запис Lena (Маршрутизація через Tor) |
| API опитувань | 8090 | HTTP | Внутрішній сервіс API |

## Специфікації облікових записів

### arsen.k111999@gmail.com (Обліковий запис 1)
- **Маршрутизація**: Пряме з'єднання через Tailscale
- **Порт**: 8888
- **Тип IP**: Статичний швейцарський IP
- **Використання**: Швидке, стабільне з'єднання для основних завдань

### lekov00@gmail.com (Обліковий запис 2)
- **Маршрутизація**: Мережа Tor через швейцарський вихід
- **Порт**: 8889
- **Тип IP**: Ротаційні швейцарські IP
- **Використання**: Анонімний перегляд з підвищеною конфіденційністю

Обидва облікові записи надають швейцарські IP адреси і можуть використовуватися одночасно без завад.