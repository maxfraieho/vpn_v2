name: deploy_gateway
description: Install dependencies, start all workspaces, and run smoke test

steps:
  - name: install
    run: bash ~/gateway/novnc-termux/scripts/install_termux.sh
    timeout: 600

  - name: start_all
    run: bash ~/gateway/novnc-termux/scripts/start_workspace.sh all
    timeout: 120
    depends_on: install

  - name: healthcheck
    run: bash ~/gateway/novnc-termux/scripts/healthcheck.sh all
    timeout: 30
    depends_on: start_all

  - name: smoke_test
    run: bash ~/gateway/novnc-termux/scripts/smoke_test.sh
    timeout: 30
    depends_on: healthcheck
